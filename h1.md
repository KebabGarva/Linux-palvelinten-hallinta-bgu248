# Viisikko

## x)

### Salt-komentojen py√∂ritt√§minen paikallisesti

- Artikkeli esitt√§√§ esimerkkej√§ salt-komennoista, joita voi antaa paikallisesti tietokoneelle.
-   
  
### Web-sivujen tekeminen Githubilla


### Raportin kirjoittaminen

## a)
![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/465e03f7-a38d-48c9-947b-df161fdfb946)

Minulla oli salt valmiiksi asennettuna Windowsiin. T√§h√§n menness√§ olen ymm√§rt√§nyt, ett√§ voin antaa samoja komentoja powershelliin kuin tekisin tyypillisesti Tein kyseisen toimenpiteen ensimm√§isen luennon aikana. Haluan viel√§ selvitt√§√§, voiko saltin asentaa powershellin kautta. P√§√§dyin poistamaan saltin Windowsista.

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/f68d8e8c-95e8-4887-9a96-e4eebe2a0a04)

T√§m√§n j√§lkeen kokeilin pelk√§st√§√§n powershell-komennolla asentaa Saltin Windowsiin. Oikeastaan v√§litt√∂m√§sti tajusin sen olevan ep√§k√§yt√§nn√∂llist√§, koska Windowsilla ei ole samanlaista pakettivarastoa kuin Linuxissa. L√∂ysin nopean googlauksen j√§lkeen sharepointdiary.com -verkkosivulta Salaudeen Rajackin artikkelin, jossa n√§ytet√§√§n eri komentoja verkossa olevien tiedostojen lataukseen. Suoritin alla olevan komennon lataakseni Saltin asennustiedoston Windowsiin. 

`Invoke-WebRequest -Uri "https://repo.saltproject.io/salt/py3/windows/latest/Salt-Minion-3007.0-Py3-AMD64-Setup.exe" -OutFile "C:\Users\sakus\Downloads\saltohjelma.exe" -UseBasicParsing -PassThru`

Yritin aiemmin lis√§t√§ toisen komennon per√§√§n, joka lis√§isi edistymispalkin komentoon. En pystynyt siihen ilman scripti√§, ja ajattelin j√§tt√§√§ sen my√∂hemm√§lle. Ohjelma valittaa muuttujan puutteesta, ja en tied√§, miten lis√§t√§ muuttuja komentoon, joka ei hy√∂dynn√§ scripti√§. Yritin hy√∂dynt√§√§ artikkelin pohjaa. Oletin komennon toimivan, koska artikkelia oli p√§ivitetty noin 2 kuukautta sitten t√§t√§ teht√§v√§√§ tehdess√§.

`Invoke-WebRequest -Uri "https://repo.saltproject.io/salt/py3/windows/latest/Salt-Minion-3007.0-Py3-AMD64-Setup.exe" -OutFile "C:/Users/sakus/Downloads/saltohjelma.exe" -UseBasicParsing -PassThru | Write-Progress -Activity "Downloading file" -Status "Progress"`

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/e27dbc17-bb9a-4a93-a17d-811fa32df229)

Halusin hieman lis√§√§ hifistell√§, ja k√§ynnist√§√§ asennusohjelma Powershellin kautta. 

`& C:/Users/sakus/Downloads/saltohjelma.exe`

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/e8e881d1-28e1-4e1b-a933-a6a7d6d7b9dc)


T√§ss√§ vaiheessa annan installerin k√§ynnist√§√§ saltin itse.

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/2615f08c-adf7-4af9-a523-1c3a7161decf)

Varmistin viel√§, onko Salt asennettu.

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/b074c447-0358-4579-b450-9d51d5600bc7)

T√§st√§ teht√§v√§st√§ opin sen, **kuinka hidasta on manuaalisesti suorittaa komentoja ilman scriptej√§**. Tulen toivottavasti opettelemaan scripteist√§ lis√§√§ tulevaisuudessa.

## b)

Vagrantin asennuksen voi tarkistaa esimerkiksi seuraavalla komennolla: `vagrant version`
![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/cbb9ef46-8940-49db-8cd8-cd19a87b369d)

## c)

Vagrantilla uuden virtuaalikoneen voi luoda yksinkertaisimmillaan katsomalla ensin Vagrant Cloudista haluttu virtuaalikone, mink√§ j√§lkeen hy√∂dynnet√§√§n `vagrant init ESIMERKKI/KONE` -komentoa. T√∂rm√§sin [FreeCodeCampin artikkeliin](https://www.freecodecamp.org/news/create-and-manage-virtual-machines-with-vagrant/), jossa annettiin muistutus siit√§, ett√§ pit√§√§ luoda oma kansio virtuaalikoneelle. Suoritin komennon kuin `mkdir "VagrantTestiH1" ; cd VagrantTestiH1`.

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/57173b32-4e5e-472b-b037-2e2cf73ccdb8)

Itse valitsin satunnaisesti [t√§m√§n kyseisen virtuaalikoneen](https://app.vagrantup.com/debian/boxes/testing64) k√§ytett√§v√§ksi. Voimme tietenkin v√§itell√§ siit√§, oliko valinta oikeasti t√§ysin sattumaa. Suoritin `vagrant init debian/testing64` -komennon. Ajattelin testauksen vuoksi l√§hte√§ pois kyseisest√§ kansiosta pois `cd ~` -komennolla kokeillakseni, voinko k√§ynnist√§√§ vagrant-tiedoston ollesani eri kansiossa kuin itse tiedosto. Heti tajusin `Vagrant global-status` -komennon tehty√§ni, ett√§ kyseinen toimenpide on viel√§ mahdoton. Mink√§√§n tietokoneen tietoja ei tullut Powershelliin, koska itse tietokonetta ei olla edes ladattu. Se toimisi vasta my√∂hemmin. Suoritin tyls√§sti komennon `vagrant up`, jotta voin jatkaa teht√§v√§ss√§ eteenp√§in.

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/749beee4-9ce4-4b4f-a6bf-037e3defe193)

P.s Kokeilin v√§litt√∂m√§sti `vagrant halt KONEENID` -komentoa, ja sen j√§lkeen `vagrant up KONEENID`. Se taisi toimia! `Vagrant up`-komento on samaan aikaan kuin virtuaalikoneen asennus- ja p√§√§llekytkemisohjelma.

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/82bc2f97-8db0-4916-a0a5-fb7f76983759)

## d)

Muodostan ssh:lla yhteyden virtuaalikoneeseeni komennolla `vagrant ssh 7064575`.

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/38983468-d9a2-48d8-8e1f-5dd8d55db344)

Hy√∂dynt√§m√§ll√§ Tero Karvisen [Salt-komentojen py√∂ritt√§minen paikallisesti -artikkelia](https://terokarvinen.com/2021/salt-run-command-locally/) suoritin komentosarjan `sudo apt-get update & sudo apt-get -y install salt-minion && sudo salt-call --version`. Jostain syyst√§ salt-minionin lataaminen ei onnistunut, joten kokeilin `sudo apt-get upgrade`-komentoa, jonka j√§lkeen kokeilin uudestaan ladata minionin. Se ei toiminut taaskaan, koska kyseist√§ tiedostoa ei pystynyt l√∂yt√§m√§√§n.

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/e6234297-432e-4eb4-a8d5-b1eb883705da)

Salt-masteri√§k√§√§n ei l√∂yt√§nyt.

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/bba77937-b8ee-4311-9d17-58738402af50)

Apache2:n kone l√∂ysi, mik√§ h√§mmenti minua suuresti. 

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/1e229e7f-48ec-4f05-8f85-e70e09f295ee)

Mietin t√§ss√§ vaiheessa, mik√§ aiheutti ongelman. Yritin ensin katsoa `help`-komennon kautta saatavilla olevia komentoja, mink√§ j√§lkeen kokeilin viel√§ `info`-komentoa. T√§m√§ komento ei ollut saatavilla, vaikka `help`-komento kannusti k√§ytt√§m√§√§n `info`-komentoa. 

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/df18702e-f0f8-43d8-a44b-c9403f399fe0)


Vasta t√§ss√§ vaiheessa tajusin ottaa selv√§√§ erikseen Googlella, mitk√§ ovat j√§rjestelm√§- ja k√§ytt√∂j√§rjestelm√§infokomennot. 

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/6191daf1-4fde-4ccb-964a-45dda71226c0)

Tuli hieman tyhm√§ olo j√§lkeenp√§in, koska olin k√§ytt√§nyt Debianin ep√§vakaata "trixie" -julkaisua, josta ei ole viel√§k√§√§n julkistettu mink√§√§nlaista mahdollista julkaisuajankohtaa. Ryhdyin heti vaihtamaan virtuaalikonetta, ja olen luonut jo aiemmin kansion sit√§ varten. Halusin vaihtaa [debian/bullseye64 -versioon](https://app.vagrantup.com/debian/boxes/bullseye64), koska tiesin sen aiemman kokemuksen perusteella olevan vakaa, ja jossa toimii salt. Varmistin ensin vanhan virtuaalikoneen olevan poistettu, ja sen j√§lkeen py√∂ritin komennon `vagrant init debian/bullseye64 --force ; vagrant up`. Force-asetus oli ehk√§ mielest√§ni turha, mutta sen toteutin ollakseni mieless√§ni 100% varma, ett√§ se toimii.

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/818348db-8a3a-4046-a6ef-b9f6cadb23e9)


Nyt palasin takaisin siihen vaiheeseen, jossa minun on alunperin pit√§nyt olla. 

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/bac193e9-c795-4bfa-b0a0-79d0d2550bac)

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/640550d8-0024-4c11-8a92-35088477097c)

Teht√§v√§nanto venyi yll√§tt√§v√§n pitk√§ksi, mutta kokemus oli opettava!

## e) Tilafunktiot

### PKG 

PKG -tilafunktiolla hallinoidaan valmisohjelmistojen toimintaa. Esimerkiksi voimme kokeilla saltilla Apache2:n asentamista. Suoritetaan komento `sudo salt-call --local -l info state.single pkg.installed apache2`.

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/dce0653f-3526-4d3c-9f52-eb9aa54271c1)

K√§vi yksinkertaisesti huono tuuri asentamisen n√§k√∂kulmasta, koska asennustiedosto linkin takana ei ollut voimassa. Tiedosto on voimassa t√§t√§ raporttia kirjoittaessani vasta huomenna.Py√∂ritin viel√§ erikseen `which apache2`- ja `whereis apache2` -komennot ollakseni t√§ysin varma Apache2 -palvelun tiedostojen puuttumisesta.

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/0f0f6a64-0252-4eb7-84c3-80e992dd335b)

Jostain kumman syyst√§ Apache2 on asennettavissa tyypillisen `sudo apt-get install` -komennon kautta. T√§m√§n j√§lkeen pohdin, voiko vika johtua yksinkertaisesta v√§√§r√§st√§ URL-osoitteesta, jota salt k√§ytt√§√§. L√§hdin selvitt√§m√§√§n syyn suorittamalla `sudo apt policy apache2` -komennon. 

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/ac8c07f6-d836-4bbc-80c0-24ba2bf6da81)

Komentojen tulosteen perusteella salt pyrkii saamaan kaikista uusimman version, mutta kyseinen versio ei ole viel√§ voimassa. Debian saa tiedostonsa virallisen julkaisun hakemiston kautta. Saltilla voi hallinnoida ohjelmistoarkistoon liittyvi√§ asioita pkgrepo -tilafunktiolla, johon en perehdy lis√§√§ toistaiseksi. Debian 12.5 julkistettiin 10.2.2024 [t√§ss√§ Debianin julkaisemassa uutisartikkelissa](https://www.debian.org/News/2024/20240210).  [Hakemistoon, josta onnistuu valmisohjelmisto Apache2:n lataaminen](https://ftp.debian.org/debian/dists/bullseye/), tehtiin viimeeksi muokkauksia samana p√§iv√§m√§√§r√§n√§. T√§m√§n tiedon perusteella seuraavana p√§iv√§n√§ t√§t√§ raporttia tehdess√§ni tulee Debian-p√§ivityksi√§ (jee!!).

Valitaan toinen ohjelmisto ladattavaksi. Mik√§ olisi parempi ohjelmisto lataa Linux-k√§ytt√∂j√§rjestelm√§lle kuin [Cowsay](https://github.com/tnalpgge/rank-amateur-cowsay)? Suoritin komennon `sudo salt-call --local -l info state.single pkg.installed cowsay`

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/e9632f45-5c34-4e51-aac7-19d8b19ac7a3)

T√§m√§n perusteella olin jo asentanut Cowsayn t√§lle kyseiselle virtuaalikoneelle. Kirjoitin seuraavaksi komennon `sudo salt-call --local -l info state.single pkg.removed cowsay`. Hyv√§sti Cowsay :(

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/c8215841-a8bf-40d4-921c-5d2fa2c4b3a7)

Tulosteen perusteella poistaminen onnistui t√§ysin. Haluan silti varmistaa, onko kyseinen ohjelmisto poistettu kokonaan hy√∂dynt√§m√§ll√§ `which`- ja `whereis`-komentoja. 

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/b03ff6d7-462d-445b-819e-67fb9c01e332)

### File

File-tilafunktiolla hallinnoidaan tietokoneen tiedostoja ja hakemistoja. Lis√§√§n hakemiston kuin "Cowsayn-Hautajaiset-30-03-2024" komennolla `sudo salt-call --local -l info state.single file.directory ~/Cowsayn-Hautajaiset-30-03-2024`. Lis√§t√§√§n viel√§ tiedostoja, jotka liittyv√§t hautajaisiin, hakemiston sis√§lle. Hy√∂dynt√§m√§ll√§ `sudo salt-call --local -l info state.single file.managed ~/Cowsayn-Hautajaiset-30-03-2024/TIEDOSTON-ESIMERKKINIMI`-komentoa pohjana.

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/1c270fb0-b985-48de-8921-d9f087ea6fa9)


![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/750ef54b-f750-41c5-bd38-0a76bbe6ad58)

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/f08dce7e-ec9a-4726-8790-71e3d16b96bb)


![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/015f2da7-d71f-4139-8240-3e79ab8855b6)

Muuten tulosteena n√§ytet√§√§n tismalleen samanlaista informaatiota kuin PKG-funktion toteutuessa, mutta merkitt√§vin ero on kommentissa. Kommentti spesifoi, mit√§ tiedoston sis√§ll√§ on. Lis√§t√§√§n hautajaislistaan nimi√§ seuraavalla komennolla. `sudo salt-call --local -l info state.single file.managed ~/Cowsayn-Hautajaiset-30-03-2024/Hautajaisvieraat contents="Saku Laitinen"`

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/a54273e9-7939-415d-be50-879accf597dd)

### Service

Service-tilafunktiolla hallinoidaan, jotka ovat k√§yt√§nn√∂ss√§ taustalla olevii automatisoituja prosesseja, kuten esimerkiksi Samban taustaprosesseja. Samba on suosituin Windows-yhteensopivuusohjelma Linux ja Unix j√§rjestelmiin. Otetaan kyseinen palvelu mukaan t√§h√§n esimerkkiin. Suoritan komennon `sudo salt-call --local -l info state.single service.running smbd enable=True` ja sen j√§lkeen `systemctl` tarkastaakseni lopputuloksen



![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/bc55bccc-c7aa-469f-a9f4-c1912018d7e2)

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/3e7cda6d-5823-4362-997a-1ee018d8dc92)


Palvelu on jo k√§yt√∂ss√§, mutta voimme kokeilla sen sammuttamista kokonaan komennolla `sudo salt-call --local -l info state.single service.dead smbd enable=False`

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/15d785f2-02ee-496e-b83d-f2f971c761c4)

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/06c69b48-ec95-4b74-bb38-091be1fcb76d)

Haluaisin ihan huvikseen kokeilla, mit√§ tapahtuisi seuraavissa tilanteissa: `service.dead smbd enable=True` ja `service.running smbd enable=False`

***running & False***

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/b4e768d6-b2b7-486b-9c4f-a08fc596e65a)

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/611f03c4-515a-44e2-998d-f3b860958c7e)

***dead & True***

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/bedea40f-09bd-4a21-93d7-6a46d61496e8)

T√§ss√§ vaiheessa lis√§√§n alkuper√§isen komennon per√§√§n `--all`-asetuksen, ett√§ n√§en varmasti kaikki palvelut.

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/a368a630-f5ec-42e4-8b9e-7830d4ef751b)

Sammutin virtuaalikoneen `vagrant halt`-komennolla ja k√§ynnistin sen uudestaan `vagrant up`-komennolla. Yhdistin takaisin ssh:lla `vagrant ssh 6df82ef` -komennolla. 

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/f45a1b34-450b-42aa-af9d-4b479efade6c)

**Tajusin yhden kriittisen asian vasta nyt: Minun ei tarvitse komentaa Linuxia tulostamaan _kaikkien_ palveluiden tilaa.** Voin yksinkertaisesti valita haluamani palvelun esim. smbd:n komennolla `systemctl status smbd`. ü§¶ Ratkaisun yksinkertaisuus, helppous ja mukavuus on jotenkin aivan k√§sitt√§m√§t√∂nt√§ minulle!

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/afd63d75-5dca-4e20-9511-3b0d056eed1e)

Vahvistin itselleni, ett√§ enable-funktio m√§√§ritt√§√§ saltissa, k√§ynnistyyk√∂ palvelu boottausprosessin aikana vai ei.

### User

User-tilafunktion tarkoitus on hallita k√§ytt√§j√§asetuksia. K√§yt√§nn√∂ss√§ se tarkoittaa k√§ytt√§jien lis√§√§mist√§, poistamista, nime√§mist√§ ja ryhm√§n m√§√§rityst√§. Seuraavaksi n√§yt√§n esimerkkej√§ `user.present` -ja `user.absent` -komennoista.

Ensin toteutan komennon `sudo salt-call --local -l info state.single user.present bossbeibi24
 `, joka luo k√§ytt√§j√§n "bossbeibi24" koneelleni. 

 ![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/5b200c5d-670f-4fab-b819-af7041504149)

Tulos n√§ytt√§√§ tarkan kuvauksen k√§ytt√§j√§n tiedoista, ja mitk√§ tiedot puuttuvat. 

Seuraavaksi poistetaan k√§ytt√§j√§ ja varmistetaan kaikkien tiedostojen poisto komennolla `sudo salt-call --local -l info state.single user.absent bossbeibi24 purge=True `

![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/bb0d4c8f-5707-4431-9561-d874bdc944b4)

> Onko t√§m√§ oikea hetki vauvavitsille?





 ![image](https://github.com/KebabGarva/Linux-palvelinten-hallinta-bgu248/assets/89390996/55a8f320-eab1-4ed4-9f8e-64dfabbdbf88)


 














## f)

## g)







## L√§hteet

https://www.sharepointdiary.com/2021/02/download-files-using-powershell.html
https://www.freecodecamp.org/news/create-and-manage-virtual-machines-with-vagrant/
https://terokarvinen.com/2021/salt-run-command-locally/

